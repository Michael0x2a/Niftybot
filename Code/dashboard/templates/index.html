<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{{ name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" type="text/css">
    <script type="text/javascript" src="{{ url_for('static', filename='jquery-1.10.2.min.js') }}"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){
            var url = "http://" + document.domain + ":5000";
            
            function isPrimitive(obj) {
                var isBool = (typeof obj == "boolean" || obj instanceof Boolean);
                var isNum = (typeof obj == "number" || obj instanceof Number);
                var isString = (typeof obj == "string" || obj instanceof String);
                
                return isBool || isNum || isString;
            }
            
            function parseJSON(data)
            {
                var output = "<ul>";
                $.each(data.items, function(index, element) {
                    alert(element + " : " + data[element]);
                    if (isPrimitive(data[element])) {
                        output += parseSingle(element, data[element])
                    } else {
                        var temp = "<li>" + element + parseJSON(data[element]) + "</li>";
                        output += temp;
                    }
                });
                return output + "</ul>";
            }
            
            function parseSingle(name, data)
            {
                return "<li>" + name + ": " + data + "</li>";
            }
            
            function updateValues() {
                $.getJSON(url + "/state/robot")
                    .done(function(data) {
                        $("#robot-state").html(parseJSON(data["robot"]));
                    });
            }
            
            window.setInterval(updateValues, 500);
        });
    </script>
</head>
<body>
    <div id="wrapper">
        <div id="header">
            <h1>{{ name }}</h1>
        </div>
        <div id="widgets">
            <div class="widget" id="video-widget">
                <h2>Video feed</h2>
                <div id="video">
                    <p>Video here</p>
                </div>
            </div>
            <div class="widget" id="robot-widget">
                <h2>Robot state</h2>
                <div id="robot-state"></div>
            </div>
            <div class="widget" id="state">
            
            </div>
        </div>
        <div id="control">
            <div class="control" id="wheels">
            
            </div>
        </div>
    </div>
</body>
</html>
